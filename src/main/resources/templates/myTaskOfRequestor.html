<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../static/myTaskOfRequestorCSS.css" type="text/css"/>
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
        $(document).ready(function(){
            clickUnfinished();

            document.getElementById('username').innerText=localStorage.nickname;
            var username=document.getElementById('username');
            username.onmouseover=function () {
                document.getElementById("menu").style.display="inherit";
            }
            document.getElementById("userbar").onmouseleave=function (e) {
                if(e.target.id!="menu"){
                    document.getElementById("menu").style.display="none";
                }
            }

        });


        function logout(){
            window.open("./homepage.html","_self");
        }

        function goPersonalSpace(){
            window.open("./personalSpacePage.html","_self");
        }
    </script>
</head>
<body>
<!--头部-->
<div id="userbar" class="u1">
    <li class="u3"><img class="u2" src="../static/pic/logo.png" style=""></li>
    <li class="u3"><a href="./chooseNewTask.html" class="u5">任务大厅</a></li>
    <li class="u3"><a href="#" class="u5">新闻</a></li>
    <li class="u3"><a href="#" class="u5">联系</a></li>
    <li class="u3"><a href="#" class="u5">帮助</a></li>
    <li class="u4"><a href="./myTaskOfWorker.html" class="u6" id="x">我的接取</a></li>
    <li class="u4"><a href="./myTaskOfRequestor.html" class="u6"  style="color: darkviolet">我的发布</a></li>
    <li class="u4"><a href="./taskAnnouncement.html" class="u6">发布任务</a></li>
    <li class="u4"><a href="./rechargePage.html" class="u6">在线充值</a></li>
    <li class="u4">
        <a class="u7">
            你好，
            <u id="username" style="color:ghostwhite; font-size: 24px;font-family:Microsoft YaHei UI;">用户</u>
        </a>
    </li>
    <div id="menu" style="margin-left: 82%;margin-top: -3%;z-index: 5;display: none;">
        <button onclick="goPersonalSpace()" style="border-radius:0;background: black;color:white;font-size: 20px;width: 120px;border-color: white;border-width: 1px;z-index: 5;margin-top: 65px;">个人空间</button><br>
        <button onclick="logout()" style="border-radius:0;background: black;color:white;font-size: 20px;margin-top: -2px;width:120px;border-color: white;border-width: 1px;">退出账户</button>

    </div>
</div>
<!--选择-->
<div class="menubox">
    <select class="menu-select" id="menu-select" onchange="sortChange()">
        <option value ="0" class="menu-opt">默认排序</option>
        <option value ="1" class="menu-opt">按参与人数排序</option>
        <option value="2" class="menu-opt">按奖励额度排序</option>
    </select>
    <select class="menu-select" id="menu-select2" onchange="sortChange()">
        <option class="menu-opt" value="全部" selected="">全部</option>
        <option class="menu-opt" value="自然">自然</option>
        <option class="menu-opt" value="地理">地理</option>
        <option class="menu-opt" value="文化">文化</option>
        <option class="menu-opt" value="历史">历史</option>
        <option class="menu-opt" value="艺术">艺术</option>
        <option class="menu-opt" value="人物">人物</option>
        <option class="menu-opt" value="生活">生活</option>
        <option class="menu-opt" value="社会">社会</option>
        <option class="menu-opt" value="体育">体育</option>
        <option class="menu-opt" value="经济">经济</option>
        <option class="menu-opt" value="科技">科技</option>
    </select>
    <select class="menu-select" id="menu-select3" onchange="sortChange()">
        <option class="menu-opt" value="2" selected="">进行中</option>
        <option class="menu-opt" value="1">已完成</option>
        <option class="menu-opt" value="0">已关闭</option>
        <option class="menu-opt" value="3">审核中</option>
        <option class="menu-opt" value="4">未过审</option>
    </select>
    <button class="search-bt" id="search-bt" onclick="search()">搜索</button>
</div>

<!--图片加载-->

<!--任务详情-->
<div class="taskDetail" id="taskDetail">
    <!--<img class="taskDetail-m" id="taskDetail-m">-->
    <div class="taskDetail-div" id="taskDetail-div">
        <div class="taskDetail-info">
            <p class="task-infop1" id="task-infop1"></p>
            <p class="task-infop2" id="task-infop2"></p>
            <p class="task-infop3" id="task-infop3"></p>
            <p class="task-infop4" id="task-infop4"></p>
            <p class="task-infop5" id="task-infop5"></p>
            <p class="task-infop6" id="task-infop6"></p>
            <p class="task-infop7" id="task-infop7"></p>
            <p class="task-infop8" id="task-infop8"></p>
            <p class="task-infop9" id="task-infop9"></p>
            <p class="task-infop10" id="task-infop10"></p>
            <p class="task-infop11" id="task-infop11"></p>
            <p class="task-infop12" id="task-infop12"></p>
            <p class="task-infop13" id="task-infop13"></p>
        </div>
        <button class="taskDetail-close" id="taskDetail-close" onclick=taskDetailClose()>×</button>
    </div>
</div>


<!--<div class="workerlist" id="workerlist">
    <button class="workerlist-close" id="workerlist-close" onclick=workerlistClose()>×</button>
</div>-->


<!--加载-->
<script>

    var maindiv = document.createElement("div");
    maindiv.className="maindiv";
    maindiv.id="main";

    var sortCondition=2;
    var sortnum=0;
    var sortKind='全部';

    //数据
    var requestorID=localStorage.account;

    var marklist=new Array();

    //任务信息
    var taskIDs=new Array();
    var taskRequests=new Array();
    var taskTags=new Array();
    var taskCredits=new Array();
    var taskPeople=new Array();
    var taskParticipants=new Array();
    var taskPicurls=new Array();
    var taskStarttimes=new Array();
    var taskEndtimes=new Array();
    var tasknopass=new Array();
    var taskConditions=new Array();
    var taskDeadlines=new Array();
    var taskKinds=new Array();
    var taskMarks=new Array();
    //任务状态、任务完成情况

    //具体任务
    var picIDs=new Array();
    var picurls=new Array();


    var workerIDs=new Array();
    var workerNames=new Array();
    var workerTags=new Array();

    taskIDs[0]='01';
    taskIDs[1]='02';
    taskIDs[2]='03';
    taskIDs[3]='04';
    taskIDs[4]='05';
    taskConditions[0]='0';
    taskConditions[1]='1';
    taskConditions[2]='2';
    taskConditions[3]='3';
    taskConditions[4]='4';

    taskRequests[0]='水电费水电费是否水电费水电费贷方金额就过节费打飞机房管局符合规范合格的房间号长水电';
    taskRequests[1]='水电费水电费是否水电费水电费水电';
    taskRequests[2]='水电费水电费是否水电费水电费水电';
    taskRequests[3]='水电费水电费是否水电费水电费水电';
    taskRequests[4]='水电费水电费是否水电费水电费水电';
    taskTags[0]='0';
    taskTags[1]='1';
    taskTags[2]='1';
    taskTags[3]='2';
    taskTags[4]='3';
    taskCredits[0]='100';
    taskCredits[1]='100';
    taskCredits[2]='100';
    taskCredits[3]='100';
    taskCredits[4]='100';
    taskPeople[0]='100';
    taskPeople[1]='100';
    taskPeople[2]='100';
    taskPeople[3]='100';
    taskPeople[4]='100';
    taskParticipants[0]='0';
    taskParticipants[1]='0';
    taskParticipants[2]='0';
    taskParticipants[3]='0';
    taskParticipants[4]='0';
    taskPicurls[0]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    taskPicurls[1]='http://bizhi.cnanzhi.com/upload/bizhi/2014/1204/14176797213073.jpg';
    taskPicurls[2]='http://img.pconline.com.cn/images/upload/upc/tx/wallpaper/1306/09/c1/21860139_1370763185267.jpg';
    taskPicurls[3]='http://dl.bizhi.sogou.com/images/2014/01/15/491195.jpg';
    taskPicurls[4]='http://pic1.win4000.com/wallpaper/2/5486adf77972d.jpg';
    taskStarttimes[0]='20180909';
    taskStarttimes[1]='20180909';
    taskStarttimes[2]='20180909';
    taskStarttimes[3]='20180909';
    taskStarttimes[4]='20180909';
    taskKinds[0]="2342";
    taskKinds[1]="2342";
    taskKinds[2]="2342";
    taskKinds[3]="2342";
    taskKinds[4]="2342";
    taskMarks[0]="十多年健身房康师傅奴隶:23:";
    taskMarks[1]="23:123:2:";
    taskMarks[2]="23:";
    taskMarks[3]="23:345:345:";
    taskMarks[4]="23433:2342:676:";
    tasknopass[0]='';
    tasknopass[1]='';
    tasknopass[2]='';
    tasknopass[3]='';
    tasknopass[4]='时代峰峻适得府君书的合法史蒂芬霍金思考对方会尽快收到货福克斯阶段花费';

    picIDs[0]='01';
    picIDs[1]='02';
    picIDs[2]='03';
    picIDs[3]='04';
    picIDs[4]='04';
    picIDs[5]='04';
    picIDs[6]='04';
    picIDs[7]='04';
    picIDs[8]='04';
    picIDs[9]='04';
    picIDs[10]='04';
    picurls[0]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[1]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[2]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[3]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[4]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[5]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[6]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[7]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[8]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[9]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';
    picurls[10]='http://img17.3lian.com/d/file/201703/03/50f9e9abfcc6320cc918be2de99803d5.jpg';

    function sortChange() {
        var select=document.getElementById("menu-select");
        var select2=document.getElementById("menu-select2");
        var select3=document.getElementById("menu-select3");
        sortnum=select.options[select.selectedIndex].value;
        sortKind=select2.value;
        sortCondition=select3.value;
        console.log(sortKind);
        console.log(sortnum);

    }

    function search() {
        //进行中
        if(sortCondition==2){
            clickUnfinished();
        }
        //已完成
        else if(sortCondition==1){
            clickFinished();
        }
        //已关闭
        else if(sortCondition==0){
            clickEnd();
        }
        //审核中
        else if(sortCondition==3){
            clickReview();
        }
        //未过审
        else if(sortCondition==4){
            clickNopass();
        }
    }

    /*根据requestorID（？）获取该发布者的进行中任务的信息（inittask任务的id，任务要求（string）、要求标注类型（0无1整体2方框3描边）、
    积分、人数、参与者人数、第一张图片的url、开始时间、截止时间、分类、标签(分隔:)*/
    function clickUnfinished () {
        /*var obj=new Object();
        obj={
            requestorID:requestorID,
            sortNum:sortnum,//排序方式按id，1参与人数，2奖励
            sortKind:sortKind,//分类,string,全部+所有分类
        };
        var html = $.ajax({
            type: "Post",
            url: '/requestorTask/unfinished',
            data:JSON.stringify(obj),
            dataType:'json',
            contentType: "application/json",
            async: true,
            success: function(myobj) {
                taskIDs=[];
                taskRequests=[];
                taskTags=[];
                taskCredits=[];
                taskPeople=[];
                taskParticipants=[];
                taskPicurls=[];
                taskStarttimes=[];
                taskConditions=[];
                taskDeadlines=[];
                taskKinds=[];
                taskMarks=[];
                tasknopass=[];
                taskEndtimes=[];
                taskIDs=myobj.id;
                taskRequests=myobj.request;
                taskTags=myobj.tag;
                taskCredits=myobj.credit;
                taskPeople=myobj.people;
                taskParticipants=myobj.participant;
                taskPicurls=myobj.picurl;
                taskStarttimes=myobj.starttime;
                taskDeadlines=myobj.deadline;
                taskKinds=myobj.kind;
                taskMarks=myobj.marklist;
                for (var i = 0; i < taskIDs.length; i++) {
                    taskConditions[i]='2';
                }
                $("#main").children("div").remove();
                loadtask();
            },
            error: function() {
                alert("error");
            }
        });*/
        $("#main").children("div").remove();
        loadtask();
    }

    /*根据requestorID（？）获取该发布者的已关闭任务的信息（inittask任务的id，任务要求（string）、要求标注类型（0无1整体2方框3描边）、
   积分、人数、参与者人数、第一张图片的url、开始时间、截止时间 */
    function clickEnd () {
       /* var obj=new Object();
        obj={
            requestorID:requestorID,
            sortNum:sortnum,//排序方式按id，1参与人数，2奖励
            sortKind:sortKind,//分类,string,全部+所有分类
        };
        var html = $.ajax({
            type: "Post",
            url: '/requestorTask/End',
            data:JSON.stringify(obj),
            dataType:'json',
            contentType: "application/json",
            async: true,
            success: function(myobj) {
                taskIDs=[];
                taskRequests=[];
                taskTags=[];
                taskCredits=[];
                taskPeople=[];
                taskParticipants=[];
                taskPicurls=[];
                taskStarttimes=[];
                taskConditions=[];
                taskDeadlines=[];
                taskKinds=[];
                taskMarks=[];
                tasknopass=[];
                taskEndtimes=[];

                taskIDs=myobj.id;
                taskRequests=myobj.request;
                taskTags=myobj.tag;
                taskCredits=myobj.credit;
                taskPeople=myobj.people;
                taskParticipants=myobj.participant;
                taskPicurls=myobj.picurl;
                taskStarttimes=myobj.starttime;
                taskDeadlines=myobj.deadline;
                taskKinds=myobj.kind;
                taskMarks=myobj.marklist;

                for (var i = 0; i < taskIDs.length; i++) {
                    taskConditions[i]='0';
                }
                $("#main").children("div").remove();
                loadtask();
            },
            error: function() {
                alert("error");
            }
        });*/
        $("#main").children("div").remove();
        loadtask();
    }

    /*根据requestorID（？）获取该worker的已完成任务的信息任务的id，任务要求（string）、要求标注类型（0无1整体2方框3描边）、积分、人数、参与人数、第一张图片的url、开始时间、结束时间*/
    function clickFinished () {
        /*var obj=new Object();
        obj={
            requestorID:requestorID,
            sortNum:sortnum,//排序方式按id，1参与人数，2奖励
            sortKind:sortKind,//分类,string,全部+所有分类
        };
        var html = $.ajax({
            type: "Post",
            url: '/requestorTask/finished',
            data:JSON.stringify(obj),
            dataType:'json',
            contentType: "application/json",
            async: true,
            success: function(myobj) {
                taskIDs=[];
                taskRequests=[];
                taskTags=[];
                taskCredits=[];
                taskPeople=[];
                taskParticipants=[];
                taskPicurls=[];
                taskStarttimes=[];
                taskConditions=[];
                taskDeadlines=[];
                taskKinds=[];
                taskMarks=[];
                tasknopass=[];
                taskEndtimes=[];

                taskIDs=myobj.id;
                taskRequests=myobj.request;
                taskTags=myobj.tag;
                taskCredits=myobj.credit;
                taskPeople=myobj.people;
                taskParticipants=myobj.participant;
                taskPicurls=myobj.picurl;
                taskStarttimes=myobj.starttime;
                taskEndtimes=myobj.endtime;
                taskDeadlines=myobj.deadline;
                taskKinds=myobj.kind;
                taskMarks=myobj.marklist;

                for (var i = 0; i < taskIDs.length; i++) {
                    taskConditions[i]='1';
                }
                $("#main").children("div").remove();
                loadtask();
            },
            error: function() {
                alert("error");
            }
        });*/
        $("#main").children("div").remove();
        loadtask();
    }

    /*根据requestorID（？）获取该worker的审核中任务的信息（任务的id，任务要求（string）、要求标注类型（0无1整体2方框3描边）、积分、人数、第一张图片的url*/
    function clickReview () {
       /* var obj=new Object();
        obj={
            requestorID:requestorID,
            sortKind:sortKind,//分类,string,全部+所有分类
            //默认排序
        };
        var html = $.ajax({
            type: "Post",
            url: '/requestorTask/review',
            data:JSON.stringify(obj),
            dataType:'json',
            contentType: "application/json",
            async: true,
            success: function(myobj) {
                taskIDs=[];
                taskRequests=[];
                taskTags=[];
                taskCredits=[];
                taskPeople=[];
                taskParticipants=[];
                taskPicurls=[];
                taskStarttimes=[];
                taskConditions=[];
                taskDeadlines=[];
                taskKinds=[];
                taskMarks=[];
                tasknopass=[];
                taskEndtimes=[];
                taskIDs=myobj.id;
                taskRequests=myobj.request;
                taskTags=myobj.tag;
                taskCredits=myobj.credit;
                taskPeople=myobj.people;
                taskPicurls=myobj.picurl;
                taskDeadlines=myobj.deadline;
                taskKinds=myobj.kind;
                taskMarks=myobj.marklist;
                for (var i = 0; i < taskIDs.length; i++) {
                    taskConditions[i]='3';
                    taskParticipants[i]='0';
                }
                $("#main").children("div").remove();
                loadtask();
            },
            error: function() {
                alert("error");
            }
        });*/
        $("#main").children("div").remove();
        loadtask();
    }

    /*根据requestorID（？）获取该worker的未通过审核任务的信息（任务的id，任务要求（string）、要求标注类型（0无1整体2方框3描边）、积分、人数、第一张图片的url、未通过原因*/
    function clickNopass () {
       /* var obj=new Object();
        obj={
            requestorID:requestorID
        };
        var html = $.ajax({
            type: "Post",
            url: '/requestorTask/nopass',
            data:JSON.stringify(obj),
            dataType:'json',
            contentType: "application/json",
            async: true,
            success: function(myobj) {
                taskIDs=[];
                taskRequests=[];
                taskTags=[];
                taskCredits=[];
                taskPeople=[];
                taskParticipants=[];
                taskPicurls=[];
                taskStarttimes=[];
                taskConditions=[];
                taskDeadlines=[];
                taskKinds=[];
                taskMarks=[];
                tasknopass=[];
                taskEndtimes=[];
                taskIDs=myobj.id;
                taskRequests=myobj.request;
                taskTags=myobj.tag;
                taskCredits=myobj.credit;
                taskPeople=myobj.people;
                taskPicurls=myobj.picurl;
                tasknopass=myobj.reason;
                taskKinds=myobj.kind;
                taskMarks=myobj.marklist;
                taskDeadlines=myobj.deadline;
                for (var i = 0; i < taskIDs.length; i++) {
                    taskConditions[i]='4';
                    taskParticipants[i]='0';
                }
                $("#main").children("div").remove();
                loadtask();
            },
            error: function() {
                alert("error");
            }
        });*/
        $("#main").children("div").remove();
        loadtask();
    }

    function loadtask() {
        for(var i=0;i<taskPicurls.length;i++){
            marklist=taskMarks[i].split(":");
            var item=document.createElement("div");
            var img = document.createElement("img");
            var tag = document.createElement("div");
            var infonum=document.createElement("div");
            var info=document.createElement("div");
            var inforeq=document.createElement("div");
            var infokind=document.createElement("a");
            var infomark1=document.createElement("a");
            var infomark2=document.createElement("a");
            var infomark3=document.createElement("a");
            var bt = document.createElement("button");
            img.src=taskPicurls[i];
            item.className="item";
            tag.className="tag";
            infonum.className="infonum";
            infonum.innerHTML="完成度： "+taskParticipants[i]+"/"+taskPeople[i];
            info.className="info";
            var infocredit = document.createElement("h4");
            infocredit.innerHTML=taskCredits[i];
            infocredit.className="infocredit";
            info.appendChild(infocredit);
            inforeq.className="inforeq";
            if(taskConditions[i]==0){
                inforeq.innerHTML="未完成";
            }
            else if(taskConditions[i]==1){
                inforeq.innerHTML="已完成";
            }
            else if(taskConditions[i]==2){
                inforeq.innerHTML="进行中";
            }
            else if(taskConditions[i]==3){
                inforeq.innerHTML="审核中";
            }
            else if(taskConditions[i]==4){
                inforeq.innerHTML="未过审";
            }
            bt.className="bt";
            bt.id="bt"+i;
            bt.innerHTML="see";
            infokind.className='infokind';
            infokind.innerHTML=taskKinds[i];
            infomark1.className='infomark1';
            infomark2.className='infomark2';
            infomark3.className='infomark3';
            if(marklist.length==2){
                infomark1.style.display='block';
                infomark1.innerHTML=marklist[0];
            }
            else if(marklist.length==3){
                infomark1.style.display='block';
                infomark1.innerHTML=marklist[0];
                infomark2.style.display='block';
                infomark2.innerHTML=marklist[1];
            }
            else if(marklist.length==4){
                infomark1.style.display='block';
                infomark1.innerHTML=marklist[0];
                infomark2.style.display='block';
                infomark2.innerHTML=marklist[1];
                infomark3.style.display='block';
                infomark3.innerHTML=marklist[2];
            }
            tag.appendChild(infokind);
            tag.appendChild(infomark1);
            tag.appendChild(infomark2);
            tag.appendChild(infomark3);
            item.appendChild(img);
            item.appendChild(tag);
            tag.appendChild(bt);
            tag.appendChild(infonum);
            tag.appendChild(info);
            tag.appendChild(inforeq);
            maindiv.appendChild(item);
        }
        document.body.appendChild(maindiv);
        clickTaskDetail();
    }
    
    function clickTaskDetail() {
        for(var i=0;i<taskPicurls.length;i++){
            !function (i) {
                var btn=document.getElementById('bt'+i);
                btn.addEventListener("click",function () {
                    /*根据任务inittaskid获取该任务的所有图片（每张图片的id、url）*/
                   /* var obj=new Object();
                    obj={
                        taskID:taskIDs[i]
                    };
                    var html = $.ajax({
                        type: "Post",
                        url: '/requestorTask/piclist',
                        data:JSON.stringify(obj),
                        dataType:'json',
                        contentType: "application/json",
                        async: false,
                        success: function(myobj) {
                            picIDs=[];
                            picurls=[];
                            picIDs=myobj.id;
                            picurls=myobj.url;
                        },
                        error: function() {
                            alert("error");
                        }
                   });*/
                    /*点击展开查看页面*/
                    if(taskConditions[i]==2){
                        console.log("unf");
                        loadTaskUnfinishedDetail(i);
                    }
                    else if(taskConditions[i]==1){
                        console.log("f");
                        loadTaskFinishedDetail(i);
                    }
                    else if(taskConditions[i]==3){
                        console.log("review");
                        loadTaskReviewDetail(i);
                    }
                    else if(taskConditions[i]==4){
                        console.log("nopass");
                        loadTaskNopassDetail(i);
                    }
                    else if(taskConditions[i]==0){
                        console.log("end");
                        loadTaskEndDetail(i);
                    }
                })
            }(i);
        }

    }

    var taskDetail_div=document.getElementById("taskDetail-div");
    var taskDetail_pics = document.createElement("div");
    taskDetail_pics.className="taskDetail-pics";
    taskDetail_pics.id="taskDetail-pics";



    function loadTaskUnfinishedDetail(i) {
        var x=i;
        var taskDetail=document.getElementById('taskDetail');
        /*var taskDetail_m=document.getElementById("taskDetail-m");*/
        taskDetail.style.display='block';
        /*taskDetail_m.src='https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1521924911473&di=2d53d38fa788e3ce6d440518c3c6372b&imgtype=0&src=http%3A%2F%2Fimg3.fengniao.com%2Fforum%2Fsecpics%2F159%2F154%2F6350761.jpg';
     */
        var taskinfo1=document.getElementById('task-infop1');
        taskinfo1.innerText="积分: "+taskCredits[x];
        var taskinfo2=document.getElementById('task-infop2');
        if(taskTags[x]==0){
            taskinfo2.innerText="标注要求： 都可";
        }
        else if(taskTags[x]==1){
            taskinfo2.innerText="标注要求： 整体标注";
        }
        else if(taskTags[x]==2){
            taskinfo2.innerText="标注要求： 方框标注";
        }
        else if(taskTags[x]==3){
            taskinfo2.innerText="标注要求： 描边标注";
        }
        var taskinfo3=document.getElementById('task-infop3');
        taskinfo3.innerText="要求人数: "+taskPeople[x];
        var taskinfo4=document.getElementById('task-infop4');
        taskinfo4.innerText="参与人数: "+taskParticipants[x];
        var taskinfo5=document.getElementById('task-infop5');
        taskinfo5.innerText="完成情况: 进行中";
        var taskinfo6=document.getElementById('task-infop6');
        taskinfo6.innerText="开始时间： "+taskStarttimes[x];
        var taskinfo7=document.getElementById('task-infop7');
        taskinfo7.innerText="截止时间： "+taskDeadlines[x];
        /*var taskinfo7=document.getElementById('task-infop7');
        if(taskAchieves[x]==1){
            taskinfo7.innerText="领取情况： 系统分配";
        }
        else if(taskAchieves[x]==2){
            taskinfo7.innerText="领取情况： 自主领取";
        }*/
        var taskinfo8=document.getElementById('task-infop8');
        taskinfo8.innerText="要求: "+taskRequests[x];
        var taskinfo9=document.getElementById('task-infop9');
        taskinfo9.innerText="种类: "+taskKinds[x];
        var tempMarks=taskMarks[x].split(":");
        var taskinfo10=document.getElementById('task-infop10');
        var taskinfo11=document.getElementById('task-infop11');
        var taskinfo12=document.getElementById('task-infop12');
        if(tempMarks.length==2){
            taskinfo10.innerText="标签: "+tempMarks[0];
        }
        else if(tempMarks.length==3){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
        }
        else if(tempMarks.length==4){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
            taskinfo12.innerText=tempMarks[2];
        }
        $("#taskDetail-pics").children("div").remove();
        loadpics2();
    }

    function loadTaskEndDetail(i) {
        var x=i;
        var taskDetail=document.getElementById('taskDetail');
        /*var taskDetail_m=document.getElementById("taskDetail-m");*/
        taskDetail.style.display='block';
        /*taskDetail_m.src='https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1521924911473&di=2d53d38fa788e3ce6d440518c3c6372b&imgtype=0&src=http%3A%2F%2Fimg3.fengniao.com%2Fforum%2Fsecpics%2F159%2F154%2F6350761.jpg';
     */
        var taskinfo1=document.getElementById('task-infop1');
        taskinfo1.innerText="积分: "+taskCredits[x];
        var taskinfo2=document.getElementById('task-infop2');
        if(taskTags[x]==0){
            taskinfo2.innerText="标注要求： 都可";
        }
        else if(taskTags[x]==1){
            taskinfo2.innerText="标注要求： 整体标注";
        }
        else if(taskTags[x]==2){
            taskinfo2.innerText="标注要求： 方框标注";
        }
        else if(taskTags[x]==3){
            taskinfo2.innerText="标注要求： 描边标注";
        }
        var taskinfo3=document.getElementById('task-infop3');
        taskinfo3.innerText="要求人数: "+taskPeople[x];
        var taskinfo4=document.getElementById('task-infop4');
        taskinfo4.innerText="参与人数: "+taskParticipants[x];
        var taskinfo5=document.getElementById('task-infop5');
        taskinfo5.innerText="完成情况: 未完成";
        var taskinfo6=document.getElementById('task-infop6');
        taskinfo6.innerText="开始时间： "+taskStarttimes[x];
        var taskinfo7=document.getElementById('task-infop7');
        taskinfo7.innerText="截止时间： "+taskDeadlines[x];
        var taskinfo8=document.getElementById('task-infop8');
        taskinfo8.innerText="要求: "+taskRequests[x];
        var taskinfo9=document.getElementById('task-infop9');
        taskinfo9.innerText="种类: "+taskKinds[x];
        var tempMarks=taskMarks[x].split(":");
        var taskinfo10=document.getElementById('task-infop10');
        var taskinfo11=document.getElementById('task-infop11');
        var taskinfo12=document.getElementById('task-infop12');
        if(tempMarks.length==2){
            taskinfo10.innerText="标签: "+tempMarks[0];
        }
        else if(tempMarks.length==3){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
        }
        else if(tempMarks.length==4){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
            taskinfo12.innerText=tempMarks[2];
        }
        $("#taskDetail-pics").children("div").remove();
        loadpics();
    }

    function loadTaskFinishedDetail(i) {
        var x=i;
        var taskDetail=document.getElementById('taskDetail');
        /*var taskDetail_m=document.getElementById("taskDetail-m");*/
        taskDetail.style.display='block';
        /*taskDetail_m.src='https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1521924911473&di=2d53d38fa788e3ce6d440518c3c6372b&imgtype=0&src=http%3A%2F%2Fimg3.fengniao.com%2Fforum%2Fsecpics%2F159%2F154%2F6350761.jpg';
     */
        var taskinfo1=document.getElementById('task-infop1');
        taskinfo1.innerText="积分: "+taskCredits[x];
        var taskinfo2=document.getElementById('task-infop2');
        if(taskTags[x]==0){
            taskinfo2.innerText="标注要求： 都可";
        }
        else if(taskTags[x]==1){
            taskinfo2.innerText="标注要求： 整体标注";
        }
        else if(taskTags[x]==2){
            taskinfo2.innerText="标注要求： 方框标注";
        }
        else if(taskTags[x]==3){
            taskinfo2.innerText="标注要求： 描边标注";
        }
        var taskinfo3=document.getElementById('task-infop3');
        taskinfo3.innerText="要求人数: "+taskPeople[x];
        var taskinfo4=document.getElementById('task-infop4');
        taskinfo4.innerText="参与人数: "+taskParticipants[x];
        var taskinfo5=document.getElementById('task-infop5');
        taskinfo5.innerText="完成情况: 已完成";
        var taskinfo6=document.getElementById('task-infop6');
        taskinfo6.innerText="开始时间： "+taskStarttimes[x];
        var taskinfo7=document.getElementById('task-infop7');
        taskinfo7.innerText="结束时间： "+taskEndtimes[x];
        var taskinfo8=document.getElementById('task-infop8');
        taskinfo8.innerText="要求: "+taskRequests[x];
        var taskinfo9=document.getElementById('task-infop9');
        taskinfo9.innerText="种类: "+taskKinds[x];
        var tempMarks=taskMarks[x].split(":");
        var taskinfo10=document.getElementById('task-infop10');
        var taskinfo11=document.getElementById('task-infop11');
        var taskinfo12=document.getElementById('task-infop12');
        if(tempMarks.length==2){
            taskinfo10.innerText="标签: "+tempMarks[0];
        }
        else if(tempMarks.length==3){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
        }
        else if(tempMarks.length==4){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
            taskinfo12.innerText=tempMarks[2];
        }
        $("#taskDetail-pics").children("div").remove();
        loadpics(x);
    }

    function loadpics(x) {
        var z=x;
        for(var i=0;i<picurls.length;i++){
            var picitem=document.createElement("div");
            var picimg = document.createElement("img");
            var pictag = document.createElement("div");
            var picbt1 = document.createElement("button");
            picimg.src=picurls[i];
            picimg.className="picimg";
            picitem.className="picitem";
            pictag.className="pictag";
            picbt1.className="picbt1";
            picbt1.id="picbt1"+i;
            picbt1.innerHTML="see";
            picitem.appendChild(picimg);
            picitem.appendChild(pictag);
            pictag.appendChild(picbt1);
            taskDetail_pics.appendChild(picitem);
        }
        taskDetail_div.appendChild(taskDetail_pics);
        clickSeeTag(z);
    }

    function clickSeeTag(z){
        var w=z;
        for(var i=0;i<picurls.length;i++){
            !function (i) {
                var btn1=document.getElementById('picbt1'+i);
                btn1.addEventListener("click",function () {
                    /*跳转标注统计界面，id*/
                    var inittaskidc=localStorage.inittaskidc;
                    localStorage.setItem('inittaskidc',taskIDs[w]);
                    var picidm=localStorage.picidm;
                    localStorage.setItem('picidm',picIDs[i]);
                    var picurlm=localStorage.picurlm;
                    localStorage.setItem('picurlm',picurls[i]);
                    var taskmarkm=localStorage.taskmarkm;
                    localStorage.setItem('taskmarkm',taskMarks[w]);
                    var taskkindm=localStorage.taskkindm;
                    localStorage.setItem('taskkindm',taskKinds[w]);
                    var taskrequestm=localStorage.taskrequestm;
                    localStorage.setItem('taskrequestm',taskRequests[w]);
                    window.open("./taskDetailOfRequestor.html","_blank");
                })
            }(i);
        }
    }


    function loadTaskReviewDetail(i) {
        var x=i;
        var taskDetail=document.getElementById('taskDetail');
        /*var taskDetail_m=document.getElementById("taskDetail-m");*/
        taskDetail.style.display='block';
        /*taskDetail_m.src='https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1521924911473&di=2d53d38fa788e3ce6d440518c3c6372b&imgtype=0&src=http%3A%2F%2Fimg3.fengniao.com%2Fforum%2Fsecpics%2F159%2F154%2F6350761.jpg';
     */
        var taskinfo1=document.getElementById('task-infop1');
        taskinfo1.innerText="积分: "+taskCredits[x];
        var taskinfo2=document.getElementById('task-infop2');
        if(taskTags[x]==0){
            taskinfo2.innerText="标注要求： 都可";
        }
        else if(taskTags[x]==1){
            taskinfo2.innerText="标注要求： 整体标注";
        }
        else if(taskTags[x]==2){
            taskinfo2.innerText="标注要求： 方框标注";
        }
        else if(taskTags[x]==3){
            taskinfo2.innerText="标注要求： 描边标注";
        }
        var taskinfo3=document.getElementById('task-infop3');
        taskinfo3.innerText="要求人数: "+taskPeople[x];
        var taskinfo4=document.getElementById('task-infop4');
        taskinfo4.innerText="参与人数: "+taskParticipants[x];
        var taskinfo5=document.getElementById('task-infop5');
        taskinfo5.innerText="完成情况: 审核中";
        /*var taskinfo6=document.getElementById('task-infop6');
        taskinfo6.innerText="开始时间： "+taskStarttimes[x];*/
        /*var taskinfo7=document.getElementById('task-infop7');
        if(taskAchieves[x]==1){
            taskinfo7.innerText="领取情况： 系统分配";
        }
        else if(taskAchieves[x]==2){
            taskinfo7.innerText="领取情况： 自主领取";
        }*/
        var taskinfo8=document.getElementById('task-infop8');
        taskinfo8.innerText="要求: "+taskRequests[x];
        var taskinfo9=document.getElementById('task-infop9');
        taskinfo9.innerText="种类: "+taskKinds[x];
        var tempMarks=taskMarks[x].split(":");
        var taskinfo10=document.getElementById('task-infop10');
        var taskinfo11=document.getElementById('task-infop11');
        var taskinfo12=document.getElementById('task-infop12');
        if(tempMarks.length==2){
            taskinfo10.innerText="标签: "+tempMarks[0];
        }
        else if(tempMarks.length==3){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
        }
        else if(tempMarks.length==4){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
            taskinfo12.innerText=tempMarks[2];
        }
        $("#taskDetail-pics").children("div").remove();
        loadpics2();
    }


    function loadTaskNopassDetail(i) {
        var x=i;
        var taskDetail=document.getElementById('taskDetail');
        /*var taskDetail_m=document.getElementById("taskDetail-m");*/
        taskDetail.style.display='block';
        /*taskDetail_m.src='https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1521924911473&di=2d53d38fa788e3ce6d440518c3c6372b&imgtype=0&src=http%3A%2F%2Fimg3.fengniao.com%2Fforum%2Fsecpics%2F159%2F154%2F6350761.jpg';
     */
        var taskinfo1=document.getElementById('task-infop1');
        taskinfo1.innerText="积分: "+taskCredits[x];
        var taskinfo2=document.getElementById('task-infop2');
        if(taskTags[x]==0){
            taskinfo2.innerText="标注要求： 都可";
        }
        else if(taskTags[x]==1){
            taskinfo2.innerText="标注要求： 整体标注";
        }
        else if(taskTags[x]==2){
            taskinfo2.innerText="标注要求： 方框标注";
        }
        else if(taskTags[x]==3){
            taskinfo2.innerText="标注要求： 描边标注";
        }
        var taskinfo3=document.getElementById('task-infop3');
        taskinfo3.innerText="要求人数: "+taskPeople[x];
        var taskinfo4=document.getElementById('task-infop4');
        taskinfo4.innerText="参与人数: "+taskParticipants[x];
        var taskinfo5=document.getElementById('task-infop5');
        taskinfo5.innerText="完成情况: 未通过";
        /*var taskinfo6=document.getElementById('task-infop6');
        taskinfo6.innerText="开始时间： "+taskStarttimes[x];*/
        /*var taskinfo7=document.getElementById('task-infop7');
        if(taskAchieves[x]==1){
            taskinfo7.innerText="领取情况： 系统分配";
        }
        else if(taskAchieves[x]==2){
            taskinfo7.innerText="领取情况： 自主领取";
        }*/
        var taskinfo8=document.getElementById('task-infop8');
        taskinfo8.innerText="要求: "+taskRequests[x];
        var taskinfo9=document.getElementById('task-infop9');
        taskinfo9.innerText="种类: "+taskKinds[x];
        var tempMarks=taskMarks[x].split(":");
        var taskinfo10=document.getElementById('task-infop10');
        var taskinfo11=document.getElementById('task-infop11');
        var taskinfo12=document.getElementById('task-infop12');
        if(tempMarks.length==2){
            taskinfo10.innerText="标签: "+tempMarks[0];
        }
        else if(tempMarks.length==3){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
        }
        else if(tempMarks.length==4){
            taskinfo10.innerText="标签: "+tempMarks[0];
            taskinfo11.innerText=tempMarks[1];
            taskinfo12.innerText=tempMarks[2];
        }
        var taskinfo13=document.getElementById('task-infop13');
        taskinfo13.innerText="未通过原因: "+tasknopass[x];
        $("#taskDetail-pics").children("div").remove();
        loadpics2();
    }

    function loadpics2() {
        for(var i=0;i<picurls.length;i++){
            var picitem=document.createElement("div");
            var picimg = document.createElement("img");
            var pictag = document.createElement("div");
            picimg.src=picurls[i];
            picimg.className="picimg";
            picitem.className="picitem";
            pictag.className="pictag";
            picitem.appendChild(picimg);
            picitem.appendChild(pictag);
            taskDetail_pics.appendChild(picitem);
        }
        taskDetail_div.appendChild(taskDetail_pics);
    }


    function taskDetailClose() {
        var taskDetail=document.getElementById('taskDetail');
        taskDetail.style.display='none';
    }

    function workerlistClose() {
        var workerlist =document.getElementById('workerlist');
        workerlist.style.display='none';
    }



    /*workerIDs[0]="2344";
    workerIDs[1]="2344";
    workerIDs[2]="2344";
    workerIDs[3]="2344";
    workerNames[0]='2342424';
    workerNames[1]='2342424';
    workerNames[2]='2342424';
    workerNames[3]='2342424';*/

    function taskWorkerList(z){
        var k=z;
        var workerlist =document.getElementById('workerlist');
        workerlist.style.display='block';

        var obj=new Object();
        obj={
            picID:picIDs[k]
        };
        var html = $.ajax({
            type: "Post",
            url: '/requestorTask/workerlist',
            data:JSON.stringify(obj),
            dataType:'json',
            contentType: "application/json",
            async: false,
            success: function(myobj) {
                workerIDs=[];
                workerNames=[];
                workerTags=[];
                workerIDs=myobj.id;
                workerNames=myobj.name;
                workerTags=myobj.tag;
            },
            error: function() {
                alert("error");
            }
        });
        console.log(workerIDs[0]);


        for(var i=0;i<workerIDs.length;i++){
            var wbt=document.createElement("button");
            wbt.className="wbt";
            wbt.id="wbt"+i;
            wbt.innerHTML=workerNames[i];
            workerlist_pics.appendChild(wbt);
        }
        workerlist.appendChild(workerlist_pics);
        workerCheck(k);
    }

function workerCheck(k) {
    var m=k;
    for(var i=0;i<workerIDs.length;i++){
        !function (i) {
            var btn=document.getElementById('wbt'+i);
            btn.addEventListener("click",function () {
                /*点击展开查看页面*/
                if(workerTags[i]=='1'){
                    console.log(picurls[m]);
                    console.log(workerIDs[i]);
                    var postData ={'picSrc':picurls[m],'picID':picIDs[m],'workerAccount':workerIDs[i],'tag':1};
                    window['filter'] =postData;
                    window.open("./checkWholeLabelPage.html","_blank");
                }
                else if(workerTags[i]=='2'){
                    console.log(picurls[m]);
                    console.log(workerIDs[i]);
                    var postData ={'picSrc':picurls[m],'picID':picIDs[m],'workerAccount':workerIDs[i],'tag':1};
                    window['filter'] =postData;
                    window.open("./checkRectangleLabelPage.html","_blank");
                }
                else if(workerTags[i]=='3'){
                    console.log(picurls[m]);
                    console.log(workerIDs[i]);
                    var postData ={'picSrc':picurls[m],'picID':picIDs[m],'workerAccount':workerIDs[i],'tag':1};
                    window['filter'] =postData;
                    window.open("./checkOutlineLabelPage.html","_blank");
                }
            })
        }(i);
    }
}


</script>
</body>
</html>